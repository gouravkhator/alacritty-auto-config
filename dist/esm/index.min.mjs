import r from"path";import o from"yargs";import{hideBin as e}from"yargs/helpers";import t,{realpathSync as i}from"fs";import{pathToFileURL as n}from"url";import l from"os";import s from"yaml";import{execSync as a}from"child_process";function f(r){return r?r[0].toUpperCase()+r.substring(1).toLowerCase():void 0}const d=/^0x([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,c=/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/;function u(r){r=r.trim();if(!/^([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(r))throw new Error("Color code provided, is neither in 3 letter format nor in 6 letter format..");if(3===r.length){let o="";for(let e=0;e<=2;e++)o+=r.charAt(e)+r.charAt(e);return o}return r}function v(r){if(r&&(!r||""!==r.trim())){if(r=r.trim(),d.test(r))return"#"+u(r.substring(2));if(c.test(r))return"#"+u(r.substring(1));throw new Error("Color code is not provided in hex(0x) or hash(#) format..")}}function y(r){if(r&&(!r||""!==r.trim())){if(r=r.trim(),c.test(r))return"0x"+u(r.substring(1));if(d.test(r))return"0x"+u(r.substring(2));throw new Error("Color code provided is invalid, as it either contains invalid values or it is not in hex(0x) or hash(#) format..")}}function h(r={}){var t,i,n,l,s,a,d,c,u,v,h,g,m,p;const w="fontsize",b="bgcolor",x="fgcolor",k="selcolor",E="cursor",A="opacity",$=16,_="#111122",F="#ccccff",P="#111122",S="Block",z=1;return o(e(process.argv)).options({s:{type:"number"},b:{type:"string"},c:{type:"string"},t:{type:"string"},y:{type:"string"},o:{type:"number"}}).usage("Usage: node <javascript-file-name> [options]=[values],\nif the file you ran is a javascript file..\n\nOr just, <executable-name> [options]=[values]\n\nThe options are not required fields. If you don't provide the options, we either load your previously set alacritty config, or we set our own defaults for those options.").help("h").version("1.3.2").alias("s",w).alias("b",b).alias("c",x).alias("t",k).alias("y",E).alias("o",A).alias("h","help").alias("v","version").default(w,null!==(i=null===(t=null==r?void 0:r.font)||void 0===t?void 0:t.size)&&void 0!==i?i:$).default(b,null!==(s=null===(l=null===(n=null==r?void 0:r.colors)||void 0===n?void 0:n.primary)||void 0===l?void 0:l.background)&&void 0!==s?s:_).default(x,null!==(c=null===(d=null===(a=null==r?void 0:r.colors)||void 0===a?void 0:a.primary)||void 0===d?void 0:d.foreground)&&void 0!==c?c:F).default(k,null!==(h=null===(v=null===(u=null==r?void 0:r.colors)||void 0===u?void 0:u.selection)||void 0===v?void 0:v.text)&&void 0!==h?h:P).default(E,null!==(m=null===(g=null==r?void 0:r.cursor)||void 0===g?void 0:g.style)&&void 0!==m?m:S).default(A,null!==(p=null==r?void 0:r.background_opacity)&&void 0!==p?p:z).nargs({[w]:1,[b]:1,[x]:1,[k]:1,[E]:1,[A]:1}).describe(w,`Takes font size to be set in alacritty [default=${$}]`).describe(b,`Takes primary background color in #ffffff or #fff or 0xfff or 0xffffff format [default=${_}]`).describe(x,`Takes primary foreground color in #ffffff or #fff or 0xfff or 0xffffff format [default=${F}]`).describe(k,`Takes text color (when the area is selected) in #ffffff or #fff or 0xfff or 0xffffff format [default=${P}]`).describe(E,`Takes cursor style that can be Block or Underline or Beam [default=${S}]`).describe(A,`Takes background opacity which is between 0.0 (transparent) and 1.0 (opaque) [default=${z}]`).check((r=>{if(r.s&&(r.s<=0||r.s>40))throw new Error(`Invalid Arguments: Provided font size \`${r.s}\` is out of bounds of the display font range: 0.1 to 40.0!!`);if(r.b&&void 0===y(""+r.b))throw new Error(`Invalid Arguments: Provided background color \`${r.b}\` is neither in hash nor in hex format!!`);if(r.c&&void 0===y(""+r.c))throw new Error(`Invalid Arguments: Provided font color \`${r.c}\` is neither in hash nor in hex format!!`);if(r.t&&void 0===y(""+r.t))throw new Error(`Invalid Arguments: Provided selection text color \`${r.t}\` is neither in hash nor in hex format!!`);if(r.y&&!["Block","Underline","Beam"].includes(f(""+r.y)))throw new Error(`Invalid Arguments: Provided cursor style: \`${r.y}\` is not one of the allowed cursor styles: { block, underline, beam }`);if(r.o&&(r.o<0||r.o>1))throw new Error(`Invalid Arguments: Provided background opacity \`${r.o}\` is not in the range from 0.0 to 1.0!!`);return!0})).argv}function g(r){if("string"==typeof r){if(!r||r&&""===r.trim())return;if(r=r.trim(),d.test(r))return"#"+u(r.substring(2));if(c.test(r))return"#"+u(r.substring(1));throw new Error("Color code is not provided in hex(0x) or hash(#) format..")}if("number"==typeof r){return"#"+u(r.toString(16))}}function m(r){if("string"==typeof r){if(!r||r&&""===r.trim())return;if(r=r.trim(),c.test(r))return"0x"+u(r.substring(1));if(d.test(r))return"0x"+u(r.substring(2));throw new Error("Color code is not provided in hex(0x) or hash(#) format..")}if("number"==typeof r){return"0x"+u(r.toString(16))}}function p(){let o="which alacritty",e=r.join(l.homedir(),".config/alacritty/alacritty.yml");"Windows_NT"===l.type()&&(o="where alacritty",e=r.join(l.homedir(),"AppData","alacritty.yml"));try{a(o)}catch(r){throw new Error("Package Not Installed: alacritty is not installed in your system or it's path is not set in your PATH or environment variable. \nSo, we are sorry that you cannot use our library. \n\nPlease install alacritty and try again")}return t.existsSync(e)||(t.mkdirSync(r.dirname(e),{recursive:!0}),t.writeFileSync(e,"")),e}function w(r){let o;try{return o=t.readFileSync(r,"utf8"),s.parse(o)}catch(r){throw void 0===o?new Error("Unable to read the newly-created/original alacritty config file from the default config path..\n\nPlease verify the file/folder permissions assigned to the alacritty's default config folder.."):new Error("Existing alacritty's config file cannot be parsed.\n\nPlease fix this YAML Parse Error and try again:\n"+r.message)}}function b(o,e){try{const i=r.resolve(e,"alacritty.yml");t.mkdirSync(r.dirname(i),{recursive:!0});const n=s.stringify(o);t.writeFileSync(i,n,"utf-8"),console.log("Your configs will be applied..\nIn case, you did not see the new look in alacritty, we suggest to close and reopen all windows of alacritty")}catch(r){console.log("Sorry, some error occurred while writing configurations to the alacritty.yml file"),console.error("Error: "+r.message)}}function x(r={},o,e){var t,i,n,l,s,a,d,c,u,v,h,g,m,p;let w=null!==(n=null===(i=null===(t=null==r?void 0:r.colors)||void 0===t?void 0:t.primary)||void 0===i?void 0:i.background)&&void 0!==n?n:"",x=null!==(a=null===(s=null===(l=null==r?void 0:r.colors)||void 0===l?void 0:l.primary)||void 0===s?void 0:s.foreground)&&void 0!==a?a:"",k=null!==(c=null===(d=null==r?void 0:r.font)||void 0===d?void 0:d.size)&&void 0!==c?c:void 0,E=null!==(h=null===(v=null===(u=null==r?void 0:r.colors)||void 0===u?void 0:u.selection)||void 0===v?void 0:v.text)&&void 0!==h?h:"",A=null!==(m=null===(g=null==r?void 0:r.cursor)||void 0===g?void 0:g.style)&&void 0!==m?m:"Block",$=null!==(p=null==r?void 0:r.background_opacity)&&void 0!==p?p:void 0,{primary_bgcolor:_=w,primary_fgcolor:F=x,fontsize:P=k,selection_fgcolor:S=E,cursor_style:z=A,background_opacity:B=$}=o;if(_=y(_),F=y(F),S=y(S),P<.1||P>40)throw new Error("Font size provided is not in the range 0.1 to 40.0");if(z&&!["Block","Underline","Beam"].includes(f(z)))throw new Error("Cursor style provided is not in one of the 3 accepted styles");if(B<0||B>1)throw new Error("Background opacity provided is not in the range 0.0 to 1.0");const C=Object.assign(Object.assign({},r),{font:{size:P},colors:{primary:{background:_,foreground:F},selection:{text:S}},cursor:{style:z},background_opacity:B});return b(C,e),C}(function(){const r=i(process.argv[1]),o=n(r).href;return import.meta.url===o})()&&function(){console.log("----Alacritty Auto Config----\n");let o="";try{o=p();let e=w(o);const t=r.dirname(o);let i=h(e);x(e,{fontsize:parseFloat(""+i.s),primary_bgcolor:i.b,primary_fgcolor:i.c,selection_fgcolor:i.t,cursor_style:i.y,background_opacity:parseFloat(""+i.o)},t)}catch(r){console.error("Error: "+r.message+"\n")}}();export{p as configInit,u as convertShortToLongCode,v as convertToHash,y as convertToHex,x as editConfig,c as hash_color_regex,d as hex_color_regex,g as oldConvertToHash,m as oldConvertToHex,w as readOriginalConfig,h as takeArgumentInputs,b as writeToConfigFile};
